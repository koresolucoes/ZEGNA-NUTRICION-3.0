# Zegna Nutrición - Intelligent Nutrition Ecosystem
**Versión 3.1 - Notificaciones en Tiempo Real**

Zegna Nutrición has evolved into a comprehensive, multi-portal ecosystem for modern health professionals. Built with React and Supabase, the platform now features three distinct portals for **Clinics**, **Patients**, and collaborating **Allies**, creating an integrated care network. Its core is powered by advanced AI features for automation, a complete patient engagement suite to improve adherence, and a robust set of clinical tools.

---
## Key Features (English)

### 1. Multi-Portal Ecosystem
- **Clinic Portal:** The command center for nutritionists and staff to manage all clinical and administrative operations.
- **Patient Portal:** A dedicated, secure space for patients to engage with their treatment plan, track progress, and communicate.
- **Ally Portal:** A portal for external collaborating professionals (doctors, trainers) to join the network, manage referrals, and connect with clinics.

### 2. Advanced AI & Automation (Gemini API)
- **AI-Powered Plan Generation:** Generate complete, personalized weekly meal and exercise plans in seconds by defining patient objectives and custom instructions.
- **AI-Powered Meal Analysis:** Patients can upload photos of their meals, and the AI provides instant feedback by comparing it to their prescribed plan.
- **AI Clinical Assistant:** An integrated chat assistant within the "Consultation Mode" that can be fed context directly from the patient's timeline to answer clinical questions, summarize progress, or explain complex topics.

### 3. WhatsApp Business Integration
- **AI-Powered Virtual Assistant:** An automated WhatsApp bot handles incoming messages, answers frequently asked questions, and manages appointment requests 24/7.
- **Intelligent Tool Usage (Function Calling):** The AI can use tools to perform actions in real-time, such as checking for available appointment slots, booking appointments directly from WhatsApp, and retrieving patient-specific data (like meal plans) securely.
- **Live Chat Interface:** A built-in chat module allows professionals to take over conversations from the AI, send manual replies, and view the complete conversation history.

### 4. Patient Engagement & Gamification
- **Secure Patient Portal:** Invite patients to their own portal to view plans, track progress, manage files, and request appointments.
- **Gamification System:** A full-fledged system to boost motivation and adherence. Patients earn points for completing plans, attending appointments, and daily check-ins. They progress through ranks (from Novato to Platino) and maintain daily streaks.
- **Daily Check-ins:** Patients can log their mood, energy levels, and notes daily, providing valuable qualitative data to the professional.
- **Shared Group & Family Plans:** Create patient groups (e.g., families, couples) that can share a single service plan, including consultation limits and portal features.

### 5. Professional Collaborator Network
- **Public Clinic Directory:** Allies can browse a directory of all clinics using the platform, view their details, and request professional partnerships.
- **Integrated Referrals:** Clinics can seamlessly send patient referrals—including clinical context—to their partnered allies. Allies receive and manage these referrals directly in their portal, creating an efficient care network.
- **Professional Ally Profiles:** Collaborators manage their own professional profiles, including specialty, biography, and contact information, making them visible to all clinics in the directory.

### 6. Financial, Subscription & Growth Suite
- **SaaS Subscription Management (Mercado Pago):** A complete subscription system for clinics to manage their service tier (Free, Pro, Business) with automated billing through Mercado Pago.
- **Financial Dashboard:** A dedicated finance section to track revenue, view payment history, analyze income by service, and visualize financial performance over different time periods.
- **CFDI 4.0 Invoicing (FiscalAPI):** Integrated system for generating official Mexican tax invoices (CFDI 4.0) for payments received, compliant with SAT regulations.
- **Affiliate Program:** A built-in growth engine that allows users to generate unique referral codes, track referred clinics, and earn commissions on new subscriptions.

### 7. Comprehensive Clinical Tools Suite
- **Modular Calculators:** A suite of specialized clinical tools for Energy Requirements, Anthropometry (with Metabolic Syndrome risk), Renal Function, Diabetes (eAG), Special Populations (Maternal, Geriatric), Nutritional Support, MUST Screening, and Pediatrics.
- **Customizable Clinical References:** Create and consult a library of quick-reference cards (e.g., diagnostic criteria, lab values). The system can automatically overlay the current patient's data for instant comparison.
- **Advanced Diet Planner:** A detailed tool to build diet plans based on food equivalents, with real-time adequacy analysis.

### 8. Agenda & Virtual Waiting Room
- **Integrated Calendar:** A full-featured agenda with month and week views to manage all appointments.
- **Virtual Queue System:** Manage a live waiting room in real-time. Check-in patients, call them to specific consulting rooms, and update their status live.
- **Public Display Screen:** A dedicated, public-facing URL for a TV or tablet in the waiting room, which syncs securely via a unique pairing code and plays an audio alert when a patient is called.

### 9. Administration & Compliance
- **Team Management with Roles:** Invite members to your clinic with specific roles (Admin, Nutritionist, Assistant, Receptionist).
- **Service Plan Management:** Create custom service plans with defined durations and consultation limits.
- **Clinic Customization:** Personalize the platform's theme, logo, and set operating hours.
- **Compliance Tools (Mexico):** Features to help with LFPDPPP and NOM-004/NOM-024 compliance, including a privacy notice template, consent logging, and one-click data export for patients.

### 10. Real-Time Push Notifications
- The entire ecosystem is equipped with a push notification system. Professionals receive alerts for new appointment requests or partnership proposals. Patients are notified when their appointments are confirmed, and allies get instant notifications for new referrals, ensuring no important event is missed.

---
## Características Principales (Español)

### 1. Ecosistema Multi-Portal
- **Portal de Clínica:** El centro de mando para nutriólogos y su equipo para gestionar todas las operaciones clínicas y administrativas.
- **Portal del Paciente:** Un espacio dedicado y seguro para que los pacientes se involucren con su plan de tratamiento, sigan su progreso y se comuniquen.
- **Portal de Aliados:** Un portal para profesionales colaboradores externos (médicos, entrenadores) para unirse a la red, gestionar referidos y conectar con clínicas.

### 2. IA Avanzada y Automatización (Gemini API)
- **Generación de Planes con IA:** Genera planes de alimentación y rutinas de ejercicio semanales, completos y personalizados, en segundos, definiendo objetivos e instrucciones personalizadas.
- **Análisis de Comidas con IA:** Los pacientes pueden subir fotos de sus platillos y la IA ofrece retroalimentación instantánea comparándolos con su plan prescrito.
- **Asistente Clínico IA:** Un chat integrado en el "Modo Consulta" que puede ser alimentado con contexto del historial del paciente para responder preguntas clínicas, resumir el progreso o explicar temas complejos.

### 3. Integración con WhatsApp Business
- **Asistente Virtual con IA:** Un bot automatizado en WhatsApp gestiona mensajes entrantes, responde preguntas frecuentes y administra solicitudes de citas 24/7.
- **Uso Inteligente de Herramientas (Function Calling):** La IA puede usar herramientas para realizar acciones en tiempo real, como consultar horarios de citas disponibles, agendar citas directamente desde WhatsApp y obtener datos específicos de pacientes (como su plan de comidas) de forma segura.
- **Interfaz de Chat en Vivo:** Un módulo de chat integrado permite a los profesionales tomar el control de las conversaciones, enviar respuestas manuales y ver el historial completo de la conversación.

### 4. Engagement del Paciente y Gamificación
- **Portal Seguro para Pacientes:** Invita a los pacientes a su propio portal para ver planes, seguir su progreso, gestionar archivos y solicitar citas.
- **Sistema de Gamificación:** Un sistema completo para aumentar la motivación y la adherencia. Los pacientes ganan puntos por completar planes, asistir a citas y hacer check-ins diarios. Progresan a través de rangos (de Novato a Platino) y mantienen rachas diarias.
- **Check-in Diario:** Los pacientes pueden registrar su estado de ánimo, nivel de energía y notas diariamente, proporcionando valiosos datos cualitativos al profesional.
- **Planes Grupales y Familiares:** Crea grupos de pacientes (ej. familias, parejas) que pueden compartir un único plan de servicio, incluyendo el límite de consultas y las funcionalidades del portal.

### 5. Red de Colaboradores Profesionales
- **Directorio Público de Clínicas:** Los aliados pueden explorar un directorio de todas las clínicas en la plataforma, ver sus detalles y solicitar vínculos profesionales.
- **Referidos Integrados:** Las clínicas pueden enviar referidos de pacientes—incluyendo contexto clínico—a sus aliados vinculados. Los aliados reciben y gestionan estos referidos en su portal, creando una red de cuidado eficiente.
- **Perfiles Profesionales de Aliados:** Los colaboradores gestionan sus propios perfiles profesionales, incluyendo especialidad, biografía e información de contacto, haciéndolos visibles para todas las clínicas.

### 6. Suite Financiera, de Suscripción y Crecimiento
- **Gestión de Suscripciones SaaS (Mercado Pago):** Un sistema de suscripción completo para que las clínicas gestionen su nivel de servicio (Gratis, Pro, Business) con cobros automatizados a través de Mercado Pago.
- **Dashboard Financiero:** Una sección de finanzas dedicada para seguir ingresos, ver historial de pagos, analizar ingresos por servicio y visualizar el rendimiento financiero en diferentes periodos.
- **Facturación CFDI 4.0 (FiscalAPI):** Sistema integrado para generar facturas fiscales oficiales (CFDI 4.0) por los pagos recibidos, en cumplimiento con las regulaciones del SAT.
- **Programa de Afiliados:** Un motor de crecimiento integrado que permite a los usuarios generar códigos de referido únicos, dar seguimiento a las clínicas referidas y ganar comisiones por nuevas suscripciones.

### 7. Suite de Herramientas Clínicas Avanzadas
- **Calculadoras Modulares:** Un conjunto de herramientas clínicas especializadas para Requerimientos Energéticos, Antropometría (con riesgo de Síndrome Metabólico), Función Renal, Diabetes (eAG), Poblaciones Específicas (Materno-Infantil, Geriátrica), Soporte Nutricional, Tamizaje MUST y Pediatría.
- **Referencias Clínicas Personalizables:** Crea y consulta una biblioteca de referencia rápida (ej. criterios diagnósticos, valores de laboratorio). El sistema puede superponer los datos del paciente actual para una comparación instantánea.
- **Planificador Dietético Avanzado:** Una herramienta detallada para construir planes de alimentación basados en equivalentes, con análisis de adecuación en tiempo real.

### 8. Agenda y Sala de Espera Virtual
- **Calendario Integrado:** Una agenda completa con vistas de mes y semana para gestionar todas las citas.
- **Sistema de Fila Virtual:** Gestiona una cola de espera en tiempo real. Haz check-in, llama a pacientes a consultorios específicos y actualiza su estado en vivo.
- **Pantalla Pública:** Una URL dedicada para una TV o tablet en la sala de espera, que se sincroniza de forma segura mediante un código único y emite una alerta de audio al llamar a un paciente.

### 9. Administración y Cumplimiento Normativo
- **Gestión de Equipo con Roles:** Invita a miembros a tu clínica con roles específicos (Admin, Nutricionista, Asistente, Recepcionista).
- **Gestión de Planes de Servicio:** Crea planes de servicio personalizados con duraciones y límites de consultas definidos.
- **Personalización de Clínica:** Adapta el tema visual de la plataforma, el logo y establece los horarios de operación.
- **Herramientas de Cumplimiento (México):** Funcionalidades para ayudar con el cumplimiento de la LFPDPPP y las NOM-004/NOM-024, incluyendo una plantilla de aviso de privacidad, registro de consentimiento y exportación de datos del paciente con un clic.

### 10. Notificaciones Push en Tiempo Real
- Todo el ecosistema está equipado con un sistema de notificaciones push. Los profesionales reciben alertas de nuevas solicitudes de citas o propuestas de vínculo. Los pacientes son notificados cuando sus citas se confirman, y los aliados reciben avisos instantáneos de nuevos referidos, asegurando que ningún evento importante pase desapercibido.

---
## Roadmap - Próximas Funcionalidades

Para continuar mejorando la plataforma, se está trabajando en las siguientes características:

### 1. Agenda con Recordatorios Inteligentes y Sincronización
- **Recordatorios Proactivos:** Alertas automáticas (vía email o WhatsApp) para fomentar la ingesta de agua, seguir comidas planeadas o realizar chequeos diarios.
- **Sincronización de Calendarios:** Integración nativa con Google Calendar y iCal para una gestión de tiempo unificada.

### 2. Monitoreo de Métricas Personales
- **Seguimiento Integral:** Registro de peso, IMC, porcentaje de grasa y medidas corporales.
- **Integración con Wearables:** Sincronización con aplicaciones como Fitbit, Google Fit y Apple Health para importar datos y visualizar gráficas de evolución unificadas.

### 3. Comunicación Directa y Segura
- **Mensajería Integrada:** Un canal de chat directo y seguro dentro del portal entre el nutricionista y el paciente para resolver dudas rápidas.
- **Soporte Multimedia:** Posibilidad de enviar notas de voz o fotos para un feedback más preciso y personal.

### 4. Recomendaciones Dinámicas y Personalizadas
- **Recetario Inteligente:** Sugerencias de recetas personalizadas basadas en el plan nutricional y las preferencias del paciente.
- **Asistente de Compras:** Generación automática de listas de supermercado exportables a partir del plan semanal.

### 5. Contenido Educativo para Pacientes
- **Biblioteca de Recursos:** Acceso para pacientes a artículos, videos y tips de nutrición curados y asignados por el profesional desde la Biblioteca de Conocimiento.
- **Micro-aprendizaje:** Pequeños cursos y lecciones sobre temas de interés dentro del portal del paciente.

### 6. Integración de Pagos
- **Autogestión de Planes:** Los pacientes podrán renovar sus planes y suscripciones directamente desde el portal.
- **Transparencia Financiera:** Acceso a un historial completo de pagos y facturas.